# ==============================================================================
# TRAVIO - Docker Compose Environment Variables
# ==============================================================================
# This is the production-ready .env for Docker Compose
# Service names are used as hostnames within Docker network

# ==============================================================================
# INFRASTRUCTURE
# ==============================================================================

# PostgreSQL
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_MULTIPLE_DATABASES="travio_identity,travio_catalog,travio_inventory,travio_order,travio_payment,travio_fulfillment,travio_pricing,travio_notification,travio_fraud,travio_subscription,travio_queue,travio_operator"

# Redis
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_URL=redis:6379

# Kafka
KAFKA_BROKERS=kafka:9092

# OpenSearch
OPENSEARCH_URL=http://opensearch:9200
OPENSEARCH_USERNAME=admin
OPENSEARCH_PASSWORD=admin

# MinIO
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=tickets
MINIO_USE_SSL=false

# ScyllaDB
SCYLLA_HOST=scylla
SCYLLA_PORT=9042

# ==============================================================================
# SECURITY
# ==============================================================================
JWT_SECRET=travio-jwt-secret-change-in-production-abc123xyz
JWT_EXPIRY=15m
JWT_ACCESS_EXPIRY=15m
REFRESH_TOKEN_EXPIRY=168h
JWT_REFRESH_EXPIRY=168h
QR_SECRET_KEY=travio-qr-secret-key-change-in-production
QUEUE_TOKEN_SECRET=travio-queue-token-secret-change-in-prod

# ==============================================================================
# GATEWAY SERVICE
# ==============================================================================
GATEWAY_HTTP_PORT=8888

# Service URLs (Docker service names as hostnames)
IDENTITY_URL=identity:9081
CATALOG_URL=catalog:9082
INVENTORY_URL=inventory:9083
ORDER_URL=order:9084
PAYMENT_URL=payment:9085
FULFILLMENT_URL=fulfillment:9086
QUEUE_URL=queue:9087
SEARCH_URL=search:9088
PRICING_URL=pricing:50058
OPERATOR_URL=operator:50059
NOTIFICATION_URL=notification:8090
SUBSCRIPTION_URL=subscription:50060
FRAUD_URL=fraud:50090
REPORTING_URL=reporting:50091

# Client Config
VITE_API_URL=http://localhost:8888

# ==============================================================================
# IDENTITY SERVICE
# ==============================================================================
IDENTITY_GRPC_PORT=9081
IDENTITY_HTTP_PORT=8081
IDENTITY_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_identity?sslmode=disable

# ==============================================================================
# CATALOG SERVICE
# ==============================================================================
CATALOG_GRPC_PORT=9082
CATALOG_HTTP_PORT=8082
CATALOG_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_catalog?sslmode=disable

# ==============================================================================
# INVENTORY SERVICE
# ==============================================================================
INVENTORY_GRPC_PORT=9083
INVENTORY_HTTP_PORT=8083
INVENTORY_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_inventory?sslmode=disable
INVENTORY_REDIS_URL=redis:6379
HOLD_TTL_SECONDS=600

# ==============================================================================
# ORDER SERVICE
# ==============================================================================
ORDER_GRPC_PORT=9084
ORDER_HTTP_PORT=8084
ORDER_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_orders?sslmode=disable

# ==============================================================================
# PAYMENT SERVICE
# ==============================================================================
PAYMENT_GRPC_PORT=9085
PAYMENT_HTTP_PORT=8085
PAYMENT_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_payment?sslmode=disable

# SSLCommerz (Sandbox)
SSLCOMMERZ_STORE_ID=your_store_id
SSLCOMMERZ_STORE_PASSWD=your_store_passwd
SSLCOMMERZ_SANDBOX=true

# bKash (Sandbox)
BKASH_APP_KEY=your_app_key
BKASH_APP_SECRET=your_app_secret
BKASH_USERNAME=your_username
BKASH_PASSWORD=your_password
BKASH_SANDBOX=true

# Nagad (Sandbox)
NAGAD_MERCHANT_ID=your_merchant_id
NAGAD_MERCHANT_NUMBER=your_merchant_number
NAGAD_PUBLIC_KEY=your_public_key
NAGAD_PRIVATE_KEY=your_private_key
NAGAD_SANDBOX=true

# ==============================================================================
# FULFILLMENT SERVICE
# ==============================================================================
FULFILLMENT_GRPC_PORT=9086
FULFILLMENT_HTTP_PORT=8086
FULFILLMENT_DB_HOST=postgres
FULFILLMENT_DB_PORT=5432
FULFILLMENT_DB_USER=postgres
FULFILLMENT_DB_PASSWORD=postgres
FULFILLMENT_DB_NAME=travio_fulfillment
FULFILLMENT_DB_SSLMODE=disable
COMPANY_NAME=Travio

# ==============================================================================
# QUEUE SERVICE
# ==============================================================================
QUEUE_GRPC_PORT=9087
QUEUE_HTTP_PORT=8087
QUEUE_REDIS_ADDR=redis:6379
MAX_CONCURRENT_USERS=1000
BATCH_SIZE=50
BATCH_INTERVAL_SECONDS=10
TOKEN_TTL_SECONDS=300

# ==============================================================================
# SEARCH SERVICE
# ==============================================================================
SEARCH_GRPC_PORT=9088
SEARCH_HTTP_PORT=8088
TRIPS_INDEX=trips
STATIONS_INDEX=stations

# ==============================================================================
# PRICING SERVICE
# ==============================================================================
PRICING_GRPC_PORT=50058
PRICING_HTTP_PORT=8058
PRICING_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_pricing?sslmode=disable

# ==============================================================================
# NOTIFICATION SERVICE
# ==============================================================================
NOTIFICATION_GRPC_PORT=9090
NOTIFICATION_HTTP_PORT=8090
NOTIFICATION_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_notification?sslmode=disable

# ==============================================================================
# SUBSCRIPTION SERVICE
# ==============================================================================
SUBSCRIPTION_GRPC_PORT=50060
SUBSCRIPTION_HTTP_PORT=8060
SUBSCRIPTION_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_subscription?sslmode=disable

# ==============================================================================
# FRAUD SERVICE (Z.AI Integration)
# ==============================================================================
FRAUD_GRPC_PORT=50090
# Z.AI API Key - Get from https://z.ai/manage-apikey/apikey-list
ZAI_API_KEY=
ZAI_BASE_URL=https://api.z.ai/api/paas/v4
# Fraud detection threshold (0-100), blocks if score >= threshold
FRAUD_THRESHOLD=70
# Cache TTL for fraud analysis results
FRAUD_CACHE_TTL=5m

# User Profiling
PROFILE_ENABLED=true
PROFILE_DEVIATION_THRESHOLD=2.0
FRAUD_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_fraud?sslmode=disable

# RAG (Retrieval Augmented Generation)
RAG_ENABLED=true
RAG_TOP_K=5
RAG_SIMILARITY_THRESHOLD=0.7
# Google API Key for text-embedding-005 (free)
GOOGLE_API_KEY=

# ==============================================================================
# REPORTING SERVICE (ClickHouse OLAP)
# ==============================================================================
REPORTING_GRPC_PORT=50091
CLICKHOUSE_HOST=clickhouse
CLICKHOUSE_PORT=9000
CLICKHOUSE_DATABASE=travio_analytics
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=
REPORT_BATCH_SIZE=10000
REPORT_FLUSH_INTERVAL=5s
KAFKA_ENABLED=true
SCHEDULER_ENABLED=true

# Email (SMTP) - Configure for production
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@travio.com

# SMS (Twilio) - Configure for production
TWILIO_ACCOUNT_SID=your_account_sid
TWILIO_AUTH_TOKEN=your_auth_token
TWILIO_FROM_NUMBER=+1234567890

# Push Notifications (Firebase) - Configure for production
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_CREDENTIALS_FILE=/app/firebase-credentials.json

# Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# ==============================================================================
# mTLS CONFIGURATION (Uncomment for Production)
# ==============================================================================
# Mount certs volume and set these paths
# TLS_CERT_FILE=/certs/service.crt
# TLS_KEY_FILE=/certs/service.key
# TLS_CA_FILE=/certs/ca.crt

# ==============================================================================
# EVENTS SERVICE
# ==============================================================================
EVENTS_GRPC_PORT=9091
EVENTS_HTTP_PORT=8092
EVENTS_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_events?sslmode=disable
EVENTS_URL=events:9091

# ==============================================================================
# FLEET SERVICE
# ==============================================================================
FLEET_GRPC_PORT=9093
FLEET_HTTP_PORT=8093
FLEET_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_fleet?sslmode=disable
FLEET_URL=fleet:9093

# ==============================================================================
# CRM SERVICE
# ==============================================================================
CRM_GRPC_PORT=9094
CRM_HTTP_PORT=8094
CRM_DATABASE_URL=postgres://postgres:postgres@postgres:5432/travio_crm?sslmode=disable
CRM_URL=crm:9094
